<!doctype html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/html">
<head>
    <!-- 必须的 meta 标签 -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>work</title>
    <!-- CSS 文件 -->
    <link rel="stylesheet" href="./css/bootstrap.css">
    <link rel="stylesheet" href="./css/index.css">

    <!-- 引入js文件 -->
    <script src="./js/jquery-3.7.1.js"></script>
    <script src="./js/bootstrap.bundle.js"></script>
    <script src="./js/index.js"></script>
    <script src="./js/http_cdn.jsdelivr.net_npm_echarts@5.4.3_dist_echarts.js"></script>
    <script src="./js/http_unpkg.com_vue@3_dist_vue.global.js"></script>

    <style>
        /* 用于底下3个弹出层 */
        .zjh-canvas-border {
            padding-top: 2rem;
        }

        .myCanvas {
            height: 50%;
            border-radius: 20px 20px 0 0;
            --bs-offcanvas-height: initial;
            background-image: linear-gradient(45deg, #D8DCF2, #F2E0DF, #D8E6F2, #F2F2F2);
        }

        .myLineMode {
            width: 100%;
            height: 48px;
            border-radius: 24px 24px 25px 25px;
        }

        .myBottom {
            background-color: black;
            color: white;
            padding: 0;
        }

        @keyframes bounceIn {
            0% {
                transform: translateX(-100vw);
            }
            70% {
                transform: translateX(1rem);
            }
            100% {
                transform: translateX(0);
            }
        }

    </style>
</head>
<body>
<div id="app">
    <!-- 进度条 -->
    <div style="width: 100vw; height: 100vh; position: absolute; display: flex; align-items: center; justify-content: center">
        <div style="position: relative; width: 80%; height: 50%; background-color: #458A8AFF; border-radius: 1rem">
            <div style="width: 100%; height: 100%; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center;">

                <div class="progress" role="progressbar" aria-label="Example with label" aria-valuenow="25"
                     aria-valuemin="0" aria-valuemax="100"
                     style="width: 80%; height: 1.5rem">
                    <div class="progress-bar" :style="width">{{ width.width }}</div>
                </div>
                <div style="margin-top: 1rem; color: white">
                    {{ textValue }}
                </div>
            </div>
        </div>
    </div>

    <!-- 弹窗 -->
    <div style=" position: absolute; z-index: 2; width: 100vw; height: 100vh;
                                                display: flex; align-items: center; justify-content: center; flex-direction: row"
         v-if="showModal" :style="moveModal">
        <div class="myCanvas" style="position: relative; width: 80%; height: 50%;  border-radius: 1rem">
            <div style="width: 100%; height: 100%; position: relative;  padding: 10% 0;
                    display: flex; justify-content: flex-start; align-items: center; flex-direction: column;">

                <!-- <div style="position: absolute; right: 1rem; top: 1rem;"> -->
                <!--     <button type="button" class="btn-close" aria-label="Close" style="" -->
                <!--             @click="canvasBottomClose()"></button> -->
                <!-- </div> -->
                <div class="" style="font-size: 17px; margin-top: 2rem; margin-left: 0.5rem">
                    请输入手机号作为您的登录名
                </div>
                <div class="" style="position:relative;">
                </div>
                <div class=" canvasBottom-main-telephone" style="margin: 5rem auto 0 auto; width: 80%">
                    <input class="form-control myLineMode" type="tel" enterkeyhint="next" name="mobile"
                           placeholder="请输入您的手机号码"/>
                </div>
                <div class="" style="width: 80%; margin-top: 1rem;">
                    <button class="btn myLineMode myBottom" style="width: 100%" @click="pushData()">
                        <span style="color: white">确认完成</span>
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>
<script>

    const {createApp, ref, onMounted} = Vue;
    const UpIcon = {
        template: `
        `,
        setup() {
        }
    };

    const App = {
        //使用短横线命名
        components: {
            UpIcon,
        },
        setup() {
            const width = ref({
                width: 0 + "%",
            });

            let widthValue = ref(0);
            // let offCanvas = Object;
            const textValue = ref("系统排队中");

            const showModal = ref(false);

            const moveModal = ref({
                transform: " translateX(-100vw)",
            });

            const canvasBottomClose = () => {
                // offCanvas.hide();
                showModal.value = false;
            };

            const mySleep = async (ms = 1000) => {
                return new Promise(resolve => setTimeout(resolve, ms));
            };

            const showText = (value = 90, msg = "", time = 50) => {
                let ca = 0;
                const textTemp = textValue.value;
                const dataBreak = 2;
                const timeRun = setInterval(() => {
                    if (widthValue.value >= value) {
                        clearInterval(timeRun);
                    }
                    ca++;
                    if (ca === dataBreak) {
                        textValue.value = textTemp + "."
                    } else if (ca === dataBreak * 2) {
                        textValue.value = textTemp + ".."
                    } else if (ca === dataBreak * 3) {
                        textValue.value = textTemp + "..."
                        ca = 0;
                    }

                    width.value.width = widthValue.value + "%";
                    widthValue.value++;
                }, time);
            }

            const goTo = async () => {

                showModal.value = true;
                setTimeout(() => {moveModal.value.animation = "bounceIn 0.8s cubic-bezier(0.4, 0, 1, 1) forwards"}, 100);

                showText(20, "", 100);
                await mySleep((20 + 2) * 100);

                const randomValue = Math.floor(Math.random() * 100);
                textValue.value = "前面还有" + randomValue + "位用户";
                const randomValue1 = Math.floor(Math.random() * 10 + 35);
                showText(randomValue1, "", 200);
                await mySleep((randomValue1 + 5 - 20) * 200);

                textValue.value = "AI模型创建中";
                const randomValue2 = Math.floor(Math.random() * 10 + 70);
                showText(randomValue2, "", 200);
                await mySleep((randomValue2 - randomValue1 + 5) * 100);

                textValue.value = "汇智AI账户生成中";
                // const randomValue3 =  Math.floor(Math.random() * 10 + 80);
                showText(90, "", 100);
                await mySleep((90 - randomValue2 + 12) * 100);

                showModal.value = true;
            }

            onMounted(() => {
                // offCanvas = new bootstrap.Offcanvas("#canvasBottom");

                goTo();
            })

            return {
                width, widthValue, canvasBottomClose,
                textValue, showModal, moveModal,
            };
        }
    };

    createApp(App).mount('#app');
</script>
</body>
</html>
